<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Llanelli & Dunvant Tracker</title>
    <style>
        :root { --bg: #f0f2f5; --card: #ffffff; --text: #333; --accent: #1a73e8; --border: #ddd; }
        [data-theme="dark"] { --bg: #121212; --card: #1e1e1e; --text: #e0e0e0; --accent: #8ab4f8; --border: #444; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); padding: 15px; margin: 0; transition: 0.3s; }
        .container { max-width: 600px; background: var(--card); padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin: auto; }
        .stats-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; text-align: center; }
        .stat-box { background: var(--accent); color: #fff; padding: 10px; border-radius: 8px; font-size: 0.8rem; }
        .stat-box b { display: block; font-size: 1.4rem; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; }
        select, input { width: 100%; padding: 10px; background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: 6px; box-sizing: border-box; }
        .flex-group { display: flex; gap: 10px; align-items: flex-end; }
        button { padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-add { background: var(--accent); color: white; width: 100%; margin: 10px 0; }
        .btn-tool { background: #6c757d; color: white; padding: 10px 15px; }
        .btn-danger { background: #dc3545; color: white; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; font-size: 0.85rem; }
        th, td { padding: 10px; border-bottom: 1px solid var(--border); text-align: center; }
        .tag { font-size: 0.7rem; font-weight: bold; color: var(--accent); }
    </style>
</head>
<body>

<div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2>âš½ Match Tracker</h2>
        <button class="btn-tool" onclick="toggleTheme()">ðŸŒ“</button>
    </div>

    <div class="stats-row">
        <div class="stat-box">Played<b id="st-m">0</b></div>
        <div class="stat-box" style="background:#28a745">Wins<b id="st-w">0</b></div>
        <div class="stat-box" style="background:#f39c12">Goals<b id="st-g">0</b></div>
    </div>

    <div class="form-group">
        <label>Playing For:</label>
        <select id="myTeam" onchange="loadOptions()"></select>
    </div>

    <div class="form-group">
        <label>Opponent:</label>
        <div class="flex-group">
            <select id="oppList" style="flex-grow: 1;"></select>
            <button class="btn-tool" onclick="addOpponent()">+</button>
            <button class="btn-danger" onclick="deleteOpponent()">ðŸ—‘</button>
        </div>
    </div>

    <div class="form-group">
        <label>Goal Scorer:</label>
        <select id="scorer"></select>
    </div>

    <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <div class="form-group"><label>Our Score:</label><input type="number" id="hS" value="0"></div>
        <div class="form-group"><label>Their Score:</label><input type="number" id="aS" value="0"></div>
    </div>

    <button class="btn-add" onclick="saveMatch()">âž• Save Match</button>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <button class="btn-tool" style="background:#28a745" onclick="exportHTML()">ðŸ“„ Export HTML</button>
        <button class="btn-tool" style="background:#dc3545" onclick="resetAll()">ðŸ—‘ Reset All</button>
    </div>

    <table id="matchTable">
        <thead><tr><th>Team</th><th>Vs</th><th>Score</th><th>Scorer</th></tr></thead>
        <tbody></tbody>
    </table>
</div>

<script>
    let data = JSON.parse(localStorage.getItem('footy_config')) || {
        "Llanelli Town": { opps: ["Garden Village", "Carmarthen"], players: ["Your Son", "Mate 1"] },
        "Dunvant 3X": { opps: ["Mumbles", "Bishopston"], players: ["Your Son", "Mate A"] }
    };

    function toggleTheme() {
        const b = document.body;
        b.setAttribute('data-theme', b.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
    }

    function loadOptions() {
        const team = document.getElementById('myTeam');
        if(!team.innerHTML) Object.keys(data).forEach(t => team.add(new Option(t,t)));
        
        const selTeam = team.value;
        const oppS = document.getElementById('oppList');
        const scS = document.getElementById('scorer');
        
        oppS.innerHTML = ""; scS.innerHTML = "<option>None</option>";
        data[selTeam].opps.forEach(o => oppS.add(new Option(o,o)));
        data[selTeam].players.forEach(p => scS.add(new Option(p,p)));
    }

    function addOpponent() {
        const name = prompt("Enter new opponent name:");
        if(name) {
            const team = document.getElementById('myTeam').value;
            data[team].opps.push(name);
            localStorage.setItem('footy_config', JSON.stringify(data));
            loadOptions();
        }
    }

    function deleteOpponent() {
        const team = document.getElementById('myTeam').value;
        const opp = document.getElementById('oppList').value;
        if(confirm(`Delete ${opp} from list?`)) {
            data[team].opps = data[team].opps.filter(o => o !== opp);
            localStorage.setItem('footy_config', JSON.stringify(data));
            loadOptions();
        }
    }

    function saveMatch() {
        const m = {
            t: document.getElementById('myTeam').value,
            o: document.getElementById('oppList').value,
            h: parseInt(document.getElementById('hS').value),
            a: parseInt(document.getElementById('aS').value),
            s: document.getElementById('scorer').value
        };
        let h = JSON.parse(localStorage.getItem('footy_history') || "[]");
        h.push(m);
        localStorage.setItem('footy_history', JSON.stringify(h));
        render();
    }

    function render() {
        const h = JSON.parse(localStorage.getItem('footy_history') || "[]");
        const tbody = document.querySelector("#matchTable tbody");
        tbody.innerHTML = "";
        let wins = 0, goals = 0;

        [...h].reverse().forEach(x => {
            let r = tbody.insertRow();
            r.innerHTML = `<td><span class="tag">${x.t}</span></td><td>${x.o}</td><td>${x.h}-${x.a}</td><td>${x.s}</td>`;
            if(x.h > x.a) wins++;
            if(x.s === "Your Son") goals++;
        });

        document.getElementById('st-m').innerText = h.length;
        document.getElementById('st-w').innerText = wins;
        document.getElementById('st-g').innerText = goals;
    }

    function exportHTML() {
        const html = `<html>${document.documentElement.innerHTML}</html>`;
        const blob = new Blob([html], {type: 'text/html'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'Football_Stats_Backup.html';
        a.click();
    }

    function resetAll() { if(confirm("Clear all matches?")) { localStorage.removeItem('footy_history'); render(); } }

    loadOptions(); render();
</script>
</body>
</html>
